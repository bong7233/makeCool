<!DOCTYPE html>
<html lang="kr-KR">
  <head>
    <!-- Webpage Title -->
    <title>Information | makeCool</title>

    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" />
    <!--      content="width=device-width, initial-scale=1, shrink-to-fit=no"-->
    <!--    />-->

    <!-- Bulma CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"
    />
    <!-- Font Awesome CSS -->
    <link
      href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../static/css/information.css" />
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script defer src="../static/js/detailBox.js"></script>
    <script>
      function change_up() {
        let password = $("#input-password").val();
        let password2 = $("#input-password2").val();
        let name = $("#input-name").val();
        let age = $("#input-age").val();
        console.log(password, password2);

        if (password == "") {
          $("#help-password")
            .text("비밀번호를 입력해주세요.")
            .removeClass("is-safe")
            .addClass("is-danger");
          $("#input-password").focus();
          return;
        } else if (!is_password(password)) {
          $("#help-password")
            .text(
              "비밀번호의 형식을 확인해주세요. 영문과 숫자 필수 포함, 특수문자(!@#$%^&*) 사용가능 8-20자"
            )
            .removeClass("is-safe")
            .addClass("is-danger");
          $("#input-password").focus();
          return;
        } else {
          $("#help-password")
            .text("사용할 수 있는 비밀번호입니다.")
            .removeClass("is-danger")
            .addClass("is-success");
        }
        if (password2 == "") {
          $("#help-password2")
            .text("비밀번호를 입력해주세요.")
            .removeClass("is-safe")
            .addClass("is-danger");
          $("#input-password2").focus();
          return;
        } else if (password2 != password) {
          $("#help-password2")
            .text("비밀번호가 일치하지 않습니다.")
            .removeClass("is-safe")
            .addClass("is-danger");
          $("#input-password2").focus();
          return;
        } else {
          $("#help-password2")
            .text("비밀번호가 일치합니다.")
            .removeClass("is-danger")
            .addClass("is-success");
        }
        $.ajax({
          type: "POST",
          url: "/api/information",
          data: {
            password_give: password,
            name_give: name,
            age_give: age,
          },
          success: function (response) {
            alert("정보변경 완료!");
            window.location.replace("/api/profile");
          },
        });
      }

      $(document).ready(function () {
        toggle_change_up();
      });
      function toggle_change_up() {
        $("#sign-up-box").toggleClass("is-hidden");
        $("#div-sign-in-or-up").toggleClass("is-hidden");
        $("#btn-check-dup").toggleClass("is-hidden");
        $("#help-password").toggleClass("is-hidden");
        $("#help-password2").toggleClass("is-hidden");
        $("#help-name").toggleClass("is-hidden");
        $("#help-age").toggleClass("is-hidden");
      }

      function is_password(asValue) {
        var regExp = /^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%^&*]{8,20}$/;
        return regExp.test(asValue);
      }

      function is_name(asValue) {
        var regExp = /^[가-힣]+$/;
        return regExp.test(asValue);
      }

      // $(document).ready(function () {
      //   toggle_change_up();
      // });
      // function toggle_sign_up() {
      //   $("#sign-up-box").toggleClass("is-hidden");
      //   $("#div-sign-in-or-up").toggleClass("is-hidden");
      //   $("#btn-check-dup").toggleClass("is-hidden");
      //   $("#help-password").toggleClass("is-hidden");
      //   $("#help-password2").toggleClass("is-hidden");
      //   $("#help-name").toggleClass("is-hidden");
      //   $("#help-age").toggleClass("is-hidden");
      // }

      /*************************
       * 로그아웃
       **************************/
      $(document).ready(function () {
        $("#logout").click(function () {
          $.removeCookie("mytoken");

          alert("로그아웃!");

          window.location.href = "/";
        });
      });
    </script>
  </head>
  <body>
    <!--김지호-->
    <div class="backImg"></div>
    <header>
      <section>
        <div onclick="location.href='/main'" class="headerLogo">
          <div>로고 이미지</div>
        </div>
        <div class="headerInfo"><div class="infoBox"></div></div>
      </section>
    </header>
    <div class="detailBox">
      <div id="profile_container">
        <div id="profile_box2"></div>
        <div class="nickName">
          <span>{{ name }}님</span>
        </div>
      </div>
      <div id="edit_container">
        <div class="editPassword">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            />
          </svg>
        </div>
        <div class="editFavorite">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"
            />
          </svg>
          <a href="/favorite"><span>즐겨찾기</span></a>
        </div>
        <div class="editLogout">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"
            />
          </svg>
          <div class="logoutBtn">
            <a id="logout"><span>로그아웃</span></a>
          </div>
        </div>
      </div>
    </div>
    <!--/김지호-->
    <div class="wrapper">
      <section>
        <div class="hero-body has-text-centered">
          <h1 class="title is-sparta">{{ name }}님</h1>
          <span class="subtitle is-sparta">회원정보 변경</span>
        </div>
        <div class="container">
          <div class="box" style="max-width: 480px; margin: auto">
            <article class="media">
              <div class="media-content">
                <div class="content">
                  <div class="field has-addons">
                    <div class="control has-icons-left" style="width: 100%">
                      <input
                        disabled="true"
                        id="input-username"
                        class="input"
                        type="text"
                        placeholder="{{ id }}"
                      />
                      <span class="icon is-small is-left"
                        ><i class="fa fa-user"></i
                      ></span>
                    </div>
                  </div>
                  <div class="field">
                    <div class="control has-icons-left" style="width: 100%">
                      <input
                        disabled="true"
                        id="input-name"
                        class="input"
                        type="text"
                        placeholder="{{ name }}"
                      />
                      <span class="icon is-small is-left"
                        ><i class="fa fa-address-card-o" aria-hidden="true"></i
                      ></span>
                    </div>
                  </div>
                  <div class="field">
                    <div class="control has-icons-left" style="width: 100%">
                      <input
                        disabled="true"
                        id="input-age"
                        class="input"
                        type="number"
                        placeholder="{{ age }}"
                      />
                      <span class="icon is-small is-left"
                        ><i class="fa fa-keyboard-o" aria-hidden="true"></i
                      ></span>
                    </div>
                    <p id="help-age" class="help is-hidden"></p>
                  </div>
                  <p id="help-id" class="help is-hidden"></p>
                  <p id="help-id-login" class="help is-danger"></p>
                  <div class="field">
                    <div class="control has-icons-left">
                      <input
                        id="input-password"
                        class="input"
                        type="password"
                        placeholder="비밀번호"
                      />
                      <span class="icon is-small is-left"
                        ><i class="fa fa-lock"></i
                      ></span>
                    </div>
                    <p id="help-password" class="help is-hidden">
                      영문과 숫자 조합의 8-20자의 비밀번호를 설정해주세요.
                      특수문자(!@#$%^&*)도 사용 가능합니다.
                    </p>
                  </div>
                  <div class="mb-5">
                    <div class="field">
                      <div class="control has-icons-left" style="width: 100%">
                        <input
                          id="input-password2"
                          class="input"
                          type="password"
                          placeholder="비밀번호 재입력"
                        />
                        <span class="icon is-small is-left"
                          ><i class="fa fa-lock"></i
                        ></span>
                      </div>
                      <p id="help-password2" class="help is-hidden">
                        비밀번호를 다시 한 번 입력해주세요.
                      </p>
                    </div>
                  </div>
                  <nav class="level is-mobile">
                    <button
                      class="level-item button is-sparta"
                      onclick="change_up()"
                    >
                      정보변경
                    </button>
                  </nav>
                </div>
              </div>
            </article>
          </div>
        </div>
      </section>
    </div>
    <!--footer-->
    <footer>
      <div class="footer_overview">
        고객센터(이용 및 결제 문의) hanghae99@makeCool.co.kr • 02-000-0000
        (유료)
        <br />
        Copyright © 2022 Corp. All rights reserved by hanghae99_1WeekTeam
      </div>
    </footer>
  </body>
</html>
